var product = [{
    id: 1,
    img: 'https://images.bike24.net/media/720/i/mb/95/02/9d/326890-00-d-683341.jpg',
    name:"Nike Sportswear Club Men's T-Shirt",
    price: 500,
    description: 'The Nike Sportswear Club T-Shirt sets you up with soft cotton jersey and a classic logo embroidered on the chest',
    type:'nike'
}, {
    id: 2,
    img: 'https://images.bike24.net/media/720/i/mb/f7/5e/c0/adidas-mens-terrex-agravic-flow-2-gore-tex-trail-running-shoes-wonder-steel-magic-grey-impact-orange-gx8674-3-1276674.jpg',
    name:"adidas Men's TERREX Agravic Flow 2",
    price: 4000,
    description: 'Enjoy dry feet and a super lightweight feel as you move from the road to the trail and back in these adidas trail running shoes. The breathable GORE-TEX membrane protects against wet conditions, while the ultra-lightweight Lightstrike cushioning provides speed and agility on rough terrain. Reliable traction on wet and dry surfaces is a given with the lugged Continental™ rubber outsole.',
    type:'adidas'
}, {
    id: 3,
    img: 'https://images.bike24.net/media/720/i/mb/c5/51/52/adidas-mens-terrex-agravic-tech-pro-trailrunning-shoes-core-black-white-solar-red-fu7634-4-1231591.jpg',
    name:"adidas Men's TERREX Agravic Tech Pro Trailrunning Shoes",
    price: 6700,
    description: "Whether you're traversing glaciers or rocky terrain, the TERREX Agravic Pro Tech trail running shoe is the perfect companion. The high-cut shoe is water-repellent and comes with an innovative fit system that allows you to adjust the fit without taking off your gloves. Plus, responsive cushioning keeps you comfortable even in low temperatures. The Continental rubber outsole provides superior grip on wet and dry surfaces.",
    type:'adidas'
}, {
    id: 4,
    img: 'https://images.bike24.net/media/720/i/mb/74/c6/5b/nike-superrep-go-3-next-nature-flyknit-mens-training-shoes-black-white-dark-smoke-grey-bright-crimson-dh3394-003-6-1288366.jpg',
    name:'Nike SuperRep',
    price:  3700 ,
    description: "Nike SuperRep Go 3 Next Nature Flyknit Men's Training Shoes - black/white-dark smoke grey-bright crimson DH3394-003", 
    type:'nike'
}, {
    id: 5,
    img: 'https://images.bike24.net/media/363/i/mb/18/08/53/nike-react-pegasus-trail-4-men-s-trail-running-shoes-black-aura-dark-grey-wolf-grey-dj6158-001-1-1216600.jpg',
    name:'Nike React Pegasus Trail 4',
    price: 3478,
    description: "The Nike React Pegasus Trail 4 gets you there and back with its supportive, springy feel. Traction underfoot lends itself to rocky terrain while still providing a smooth ride on the road. Midfoot hold is controlled by the lacing to help you find the right fit and feel. Your trusty workhorse with wings is ready for an off-road journey. Time to take off.",
    type:'nike'
}, {
    id: 6,
    img: 'https://images.bike24.net/media/363/i/mb/e8/c9/8b/nike-pro-cap-futura4kids-adjustable-hat-midnight-navy-game-royal-white-av8015-410-860252.jpg',
    name:'Nike Pro Cap',
    price: 240,
    description: "The Nike Pro Cap has Dri-FIT Technology to help your head stay dry and comfortable. It has a classic flat bill with a snapback closure for an adjustable fit.",
    type:'nike'
}, {
    id: 7,
    img: 'https://images.bike24.net/media/363/i/mb/a4/5d/ce/bv2973-010-nike-sportswear-club-fleece-men-graphic-pullover-hoodie-01-826391.jpg',
    name:'Nike Sportswear',
    price: 1300,
    description: "A wardrobe staple, the Nike Sportswear Club Fleece Pullover Hoodie gives you soft comfort in a street-ready style for an elevated, everyday look that you really can wear every day.Hood with drawstring offers adjustable coverage. Fabric is lightly brushed on the back to make it ultra-soft and comfortable. Kangaroo pocket offers convenient storage. Ribbing at the hem and cuffs.",
    type:'adidas'
}, {
    id: 8,
    img: 'https://images.bike24.net/i/mb/c3/0d/99/nike-zoom-fly-5-mens-road-running-shoes-total-orange-black-bright-crimson-white-dm8968-800-7-1320731.jpg',
    name:'Nike Zoom Fly 5',
    price: 3478,
    description: "Nike Zoom Fly 5 Men's Road Running Shoes - total orange/black-bright crimson-white DM8968-800 Close the gap between your weekend training run and your race day in a durable design that can be used not only at the start line of your favorite race, but also in the days and months following your conquest",
    type:'nike'
}, {
    id: 9,
    img: 'https://images.bike24.net/media/363/i/mb/46/c8/d4/302295-00-d-618701.jpg',
    name:'Nike Mixed Width Headbands',
    price: 480,
    description: "3 practical headbands / hairbands in different widths. The silicone material keeps the hair back. Stretch band for a comfortable fit.Included in delivery: 3 piecesSize: one size",
    type:'nike'
}, {
    id: 10,
    img: 'https://images.bike24.net/media/363/i/mb/6e/2e/f2/adidas-mens-terrex-agravic-flow-2-gore-tex-trail-running-shoes-h03182-6-1104598.jpg',
    name:"adidas Men's TERREX Agravic Flow 2",
    price: 2920,
    description: "Enjoy dry feet and a super lightweight feel as you move from the road to the trail and back in these adidas trail running shoes. The breathable GORE-TEX membrane protects against wet conditions, while the ultra-lightweight Lightstrike cushioning provides speed and agility on rough terrain. Reliable traction on wet and dry surfaces is a given with the lugged Continental™ rubber outsole.",
    type:'adidas'
}, {
    id: 11,
    img: 'https://images.bike24.net/media/363/i/mb/3a/e8/a1/adidas-men-aeroready-game-and-go-small-logo-tapered-pants-standard-black-4-1352708.jpg',
    name:"adidas Men's AEROREADY",
    price: 1530, 
    description: "When it comes to sports, it's especially important to keep your muscles warm. These adidas pants are perfect for warm-ups or when you're waiting for your turn on the sidelines. When you're called up, the zippers at the ankles make them easy to put on and take off, even with shoes on. This product is part of adidas commitments against plastic waste and is made from 100% recycled materials.",
    type:'adidas'
}, {
    id: 12,
    img: 'https://images.bike24.net/media/363/i/mb/86/4d/dc/adidas-actv-future-ultra-lite-sp0061-sport-sunglasses-matte-black-contrast-mirror-roviex-1-1274572.jpg',
    name:'adidas Cmpt B-Shield Lite SP0042 Sport Sunglasses',
    price: 5200,
    description: "The ventilation system creates a pair of glasses that are perfect for a variety of sports. The adidas Cmpt B-Shield Lite SP0042 Sport Sunglasses quick-release lenses and adjustable nose pads for crystal clear vision add comfort in all weather conditions.",
    type:'adidas'
}, {
    id: 13,
    img: 'https://images.bike24.net/media/363/i/mb/17/29/65/adidas-womens-terrex-tracerocker-1-2-zip-longsleeve-halo-blush-gu3802-9-1016744.jpg',
    name:"adidas Women's TERREX",
    price: 1400,
    description: "When you're out in the great outdoors, the first thing that counts is a positive attitude. Then comes the right equipment. This adidas longsleeve is made from moisture-wicking fabric and combines both features. Get comfortable. And go exploring.",
    type:'adidas'
}, {
    id: 14,
    img: 'https://images.bike24.net/media/363/i/mb/72/dd/c2/adidas-women-s-terrex-hike-shorts-black-gi7169-1-936121.jpg',
    name:"adidas Women's TERREX Hike Shorts",
    price: 950,
    description: "Move onward and upward in these adidas Terrex hiking shorts. The four-way stretch fabric allows for full range of movement, whether you're logging miles on a single track or scaling skyward toward the summit. The offset waist belt ensures a fit that's as comfortable as it is stylish. Store all your essentials in the zip side pockets, and off you go.",
    type:'adidas'
}, {
    id: 15,
    img: 'https://images.bike24.net/media/363/i/mb/20/d5/ff/adidas-womens-terrex-skychaser-2-mid-gore-tex-hiking-shoe-gz3037-6-1125336.jpg',
    name:"adidas Women's TERREX Skychaser 2.0",
    price: 4825,
    description: "Mud and wetness are part of every mountain hike. With this waterproof, breathable adidas TERREX Skychaser GORE-TEX 2.0 hiking boot, you'll be perfectly equipped. It guarantees sure-footedness on uneven, difficult terrain and keeps your feet nice and dry on muddy sections. In addition, the Boost midsole ensures an energetic feel. You'll want to be out and about for longer. Robust overlays and a reinforced midsole guarantee extra durability. The design is rounded off by an outsole made of Continental rubber for superior grip even in wet conditions.",
    type:'adidas'
},];

$(document).ready(() => {
    var html = '';
    for (let i = 0; i < product.length; i++) {
        html += `<div onclick="openproductDetail(${i})" class="product-items ${product[i].type}"> 
                    <img class="product-img" src="${product[i].img}" alt="">
                    <p class="font-product-nema">${product[i].name}</p>
                    <p class="font-product-price">${ number_commas(product[i].price) } THB</p>
                </div>`;
    }
    $("#productlist").html(html)

})

function number_commas(x) {
    x = x.toString();
    var pattern = /(-?\d+)(\d{3})/;
    while (pattern.test(x))
        x = x.replace(pattern, "$1,$2");
    return x
}

function searchsomething(elem) {
    
    var value = $("#"+elem.id).val()
    console.log(value)

    var html = '';
    for (let i = 0; i < product.length; i++) {
        if( product[i].name.includes(value) ) {
            html += `<div onclick="openproductDetail(${i})" class="product-items ${product[i].type}"> 
                        <img class="product-img" src="${product[i].img}" alt="">
                        <p class="font-product-nema">${product[i].name}</p>
                        <p class="font-product-price">${ number_commas(product[i].price) } THB</p>
                    </div>`;
            } 
    }
    if(html == '') {
        $("#productlist").html(`<p> Not found product </p>`)
    } 
    else {
        $("#productlist").html(html)  
    }
}

function searchproduct(param) {
    console.log(param)
    $(".product-items").css('display', 'none')
    if(param == 'all') {
        $(".product-items").css('display', 'block')
    }
    else {
        $("."+param).css('display', 'block')
    }
}

var productindex = 0;
function openproductDetail(index) {
    productindex = index;
    console.log(productindex)
    $("#modalDesc").css('display', 'flex')
    $("#mdd-img").attr('src', product[index].img);
    $("#mdd-name").text(product[index].name)
    $("#mdd-price").text(number_commas(product[index].price) + ' THB')
    $("#mdd-desc").text(product[index].description)
} 

function  closemodal() {
    $(".modal").css('display', 'none')
}
var cart = [];
function and_to_cart() {
    var pass = true;
    for (let i = 0; i < cart.length; i++) {
        if(productindex == cart[i].index) {
            console.log('found same product')
            cart[i].count++;
            pass = false;
        }
    }
    if(pass) {
        var obj = {
            index: productindex,
            id: product[productindex].id,
            name: product[productindex].name,
            price: product[productindex].price,
            img: product[productindex].img,
            count: 1
        };
        //console.log(obj)
        cart.push(obj)
    }
    console.log(cart)

    Swal.fire({
        icon: 'success',
        title: 'Add ' + product[productindex].name + ' to cart !'
    })
    $("#cartcount").css('display', 'flex').text(cart.length)
}

function opencart() {
    $("#modalCart").css('display', 'flex')
    rendercart();
}

function rendercart() {
    if(cart.length > 0) {
        var html = ''
        for ( let i = 0; i < cart.length; i++) {
            html += `<div class="carlist-items">
                        <div class="cartlist-lift">
                            <img src="${cart[i].img}">
                            <div class="carlist-detail">
                                <p class="modal-font-product-name">${cart[i].name}</p>
                                <p class="modal-font-product-price">${number_commas(cart[i].price)} THB</p>
                            </div>
                        </div>
                        <div class="cartlist-right">
                            <p onclick="deinitems('-', ${i})" class="btnc">-</p>
                            <p id="countitems${i}" style="margin:0 15px">${cart[i].count}</p>
                            <p onclick="deinitems('+', ${i})" class="btnc">+</p>
                        </div>
                    </div>    `;
        }
        $("#mycart").html(html)
    }
        
    else {
        $("#mycart").html(`<p>Not found product list</p>`)
    }
}

function deinitems(action,index) {
    if(action == '-') {
        if(cart[index].count > 0) {
            cart[index].count--;
            $("#countitems"+index).text(cart[index].count)

            if(cart[index].count <= 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Are you sure to delete?',
                    showConfirmButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'Yes, delete it!',
                    cancelButtonText: 'No, cancel!'
                }).then((res) => {
                    if(res.isConfirmed) {
                        cart.splice(index,1)
                        console.log(cart)
                        rendercart();
                        $("#cartcount").css('display', 'flex').text(cart.length)

                        if(cart.length <= 0) {
                            $("#cartcount").css('display','none')
                        }
                    }
                    else {
                        cart[index].count++;
                        $("#countitems"+index).text(cart[index].count)
                    }
                })
            }
        }
    }
    else if(action == '+') {
        cart[index].count++;
        $("#countitems"+index).text(cart[index].count)
    }
}

function buynow() {
    
    if(cart.length > 0) {
        $("#cartcount").css('display','none')
        $("#mycart").html(`<p>Not found product list</p>`)
        
        Swal.fire({
            icon:   'success',
            title:  'Product ' + product[productindex].name
                    +'\n'+
                    'Price ' + product[productindex].price + ' THB'
                    +'\n'+
                    'Y:M:D ' + ' ----:--:--' 
        }).then((res) => {
            if(res.isConfirmed) {
                cart = [];
                closemodal();
            }
        })
        
    }
    
}