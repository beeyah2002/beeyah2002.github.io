var product = [{
    id: 1,
    img: 'https://media-cdn.bnn.in.th/167680/vivo-Smartphone-Y15s-(2022)-Mystic-Blue-1-square_medium.jpg',
    name:"vivo Y15s (2022) Mystic Blue",
    price: 4299,
    description: 'โทรศัพย์มือถืือ vivo Y15s ราคารุ่นเล็ก สเปคสุดคุ้ม  3D Slim ดีไซน์ตัวเครื่องบางเพียง 8.28 mm. น้ำหนักเบา แสกนนิ้วด้านข้างอย่างรวดเร็ว Battery 5,000mAh (TYP) เล่นได้ยาวนานกว่าที่เคย',
    type:'VIVO'
}, {
    id: 2,
    img: 'https://media-cdn.bnn.in.th/196870/vivo-Smartphone-T1x-1-square_medium.jpg',
    name:"vivo T1x (4+64GB) Gravity Black",
    price: 5999,
    description: 'vivo T1x  สมาร์ทโฟน 5G สุดคุ้ม ด้วยหน้าจอ 120Hz มาพร้อม Chip Snapdragon 680 เทคโนโลยี Dynamic RAM ที่นำความจุในตัวเครื่องมาใช้เป็นแรมได้รวมสูงสุด 12GB นอกจากนี้ยังมีกล้องหลังคู่ 64MP กล้องหน้า 8MP มาพร้อมแบตเตอรี่ความจุ 5,000 mAh ที่สามารถใช้งานได้อย่างยาวนาน ทำให้คุณไม่ต้องกังวลว่าแบตจะหมดในระหว่างวัน',
    type:'VIVO'
}, {
    id: 3,
    img: 'https://media-cdn.bnn.in.th/133768/vivo-Smartphone-Y21-Metallic-Blue-1-square_medium.jpg',
    name:"vivo Y21 (4+64GB) Metallic Blue",
    price: 5699,
    description: "โทรศัพท์มือถือ vivo Y21 สี Metallic Blue หน่วยความจำ 4+64GB หน้าจอ LCD ขนาด 6.51 นิ้ว ความละเอียด HD+ (1600 x 720) CPU MediaTek Helio P35 Designเรียบหรู แบตเตอรี่อยู่ทนนาน ราคาสบายกระเป๋า",
    type:'VIVO'
}, {
    id: 4,
    img: 'https://media-cdn.bnn.in.th/197656/vivo-Smartphone-X80-1-square_medium.jpg',
    name:'vivo X80 (12+256GB) Urban Blue (5G)',
    price:  29999 ,
    description: "สมาร์ทโฟนหน้าจอขนาด 6.78 นิ้ว ภาพคมชัดระดับ Full HD+ แบตเตอรี่คุณภาพความจุแบบ Dual-Cell ขนาด 4,500 mAh ใช้งานได้อย่างยาวนาน มาพร้อมเทคโนโลยีชาร์จเร็ว 80W ทำงานบนซอฟต์แวร์ OriginOS Ocean ที่อ้างอิงพื้นฐานมาจาก Android 12 เพลิดเพลินไปกับความคมชัดของกล้องที่ถ่ายภาพคมชัดทุกมิติได้ทุกสภาพแสง", 
    type:'VIVO'
}, {
    id: 5,
    img: 'https://media-cdn.bnn.in.th/224461/vivo-Smartphone-V25-7-square_medium.jpg',
    name:'vivo V25 (8+128GB) Sunrise Gold (5G)',
    price: 13999,
    description: "vivo V25 (5G)   สมาร์ทโฟนดีไซน์สวยโดดเด่น ที่ถ่ายภาพบุคคลกลางคืนได้ดีที่สุด มาพร้อมระบบกันสั่น เวอร์ชันปรับปรุงใหม่ ทำให้ถ่ายภาพในที่แสงน้อยได้นิ่งยิ่งขึ้น ให้ภาพกลางคืนชัดเจนดังตาเห็น ด้วยการทำงานของ AI อัลกอริทึม ทำให้ใบหน้าสว่างแม้อยู่ในที่มืด ภาพสวยระดับสตูดิโอ และแบตเตอรี่ความจุขนาด 4,500 mAh ช่วยให้คุณใช้งานได้อย่างยาวนานตลอดทั้งวัน โดยไม่ต้องกังวลว่าแบตเตอรี่จะหมดในระหว่างวัน",
    type:'VIVO'
}, {
    id: 6,
    img: 'https://media-cdn.bnn.in.th/225042/Samsung-Smartphone-Galaxy-Z-Fold4-5-square_medium.jpg',
    name:' Samsung Galaxy Z Fold4 (12+512) Green (5G) ',
    price: 65900,
    description: "Galaxy Z Fold4 5G   สุดยอดนวัตกรรมสมาร์ทโฟนจอพับได้ ยุคใหม่ของสมาร์ทโฟนที่แท้จริง ที่รวมประสบการณ์ที่ดีที่สุดของ Galaxy ไว้ในเครื่องเดียว โดดเด่นไม่เหมือนใครด้วยดีไซน์หน้าจอขนาดใหญ่ให้ความรู้สึกเหมือนมีทั้งสมาร์ทโฟนและแท็ปเล็ตในเครื่องเดียว รองรับการใช้งาน S-pen ที่ตอบโจทย์ทุกไลฟสไตล์การใช้งานในปัจจุบัน สามารถใช้งานได้หลากหลายคุ้มค่าในแต่ละวันของคุณ การรับชมที่เต็มอิ่มรวมถึงการประชุมผ่านวิดีโอ ประสบการณ์การถ่ายภาพที่เหนือกว่า ตอบโจทย์ทั้งงานและชีวิตประจำวัน",
    type:'Samsung'
}, {
    id: 7,
    img: 'https://media-cdn.bnn.in.th/75387/Samsung-Galaxy-S21-Ultra-5G-Phantom-Black-1-square_medium.jpg',
    name:'Samsung Galaxy S21 Ultra (12+256) Phantom Black(5G)',
    price: 38900,
    description: "ถ่ายวิดีโอระดับ 8K ที่ความละเอียดสูงสุดเท่าที่เคยมีมาในสมาร์ทโฟน ซึ่งมีจำนวนพิกเซลที่มากกว่า 4K ถึงสี่เท่า จะทำให้การบันทึกด้วยโหมด 8K 24fps เพื่อให้ได้ภาพเคลื่อนไหวที่ดูดีกว่าในโรงภาพยนตร์อีกทั้ง 8K Video Snap ยังสามารถเก็บภาพถ่ายความละเอียดสูงได้จากวิดีโอ 8K ที่ถ่ายไว้ได้ เพื่อที่คุณจะได้ไม่ต้องตัดสินใจเลือกระหว่างการถ่ายวิดีโอหรือภาพนิ่งอีกต่อไป",
    type:'Samsung'
}, {
    id: 8,
    img: 'https://media-cdn.bnn.in.th/171873/Samsung-Smartphone-Galaxy-S22-Ultra-Burgundy--1-square_medium.jpg',
    name:'Samsung Galaxy S22 Ultra (8+128) Burgundy (5G)',
    price: 35900,
    description: "Galaxy S22 Ultra สุดยอดสมาร์ทโฟนที่รวมประสบการณ์ที่ดีที่สุดของ Galaxy ทั้งกล้องและ ปากกา S Pen ไว้ในเครื่องเดียว ตอบโจทย์ทุกไลฟสไตล์การใช้งานในปัจจุบัน ถ่ายกลางคืนสวย สว่าง คมชัดทั้งภาพนิ่งและวิดีโอ ด้วย Adaptive Pixel Technology ทำให้ขนาดพิเซลใหญ่ขึ้น เก็บแสงได้สว่าง คมชัด ครบทุกรายละเอียดแม้ในที่แสงน้อย ครั้งแรกของ S Series ที่มาพร้อมปากกา S Pen ในตัวเครื่อง เขียน วาด ลื่นขึ้น 3 เท่า แบตเตอรี่ความจุสูง 5,000 mAh รองรับการใช้งานได้มากที่สุดถึง 2 วัน",
    type:'Samsung'
}, {
    id: 9,
    img: 'https://media-cdn.bnn.in.th/151714/Samsung-Smartphone-Galaxy-Z-Flip-3-8-128-Green-5G-09-square_medium.jpg',
    name:'Samsung Galaxy Z Flip3 (8+256) Green (5G) - New',
    price: 24900,
    description: "โทรศัพท์มือถือฝาพับสุดล้ำ Samsung Galaxy Z Flip3 (5G) (8+256) สี Green ไม่เพียงแต่เข้ากับสไตล์อันเป็นเอกลักษณ์ของคุณเท่านั้น แต่ยังเหมาะกับกระเป๋าของคุณด้วย การออกแบบที่กะทัดรัดและไม่เหมือนใครที่สะดุดตาและใส่ลงในกระเป๋าเสื้อ/กระเป๋าถือได้อย่างง่ายดาย สามารถถ่ายภาพมุมที่ไม่ซ้ำใครในแบบของคุณ รับมุมมองที่ไม่เหมือนใครอย่างที่ไม่เคยมีมาก่อน เปลี่ยนเซลฟี่ที่ไม่สามารถเข้าถึงได้ก่อนหน้านี้ให้กลายเป็นความจริง ภาพกลางคืนที่สวยงามโดยไม่ต้องใช้ขาตั้งกล้อง เชื่อมต่ออยู่เสมอแม้ในขณะที่พับ ไม่พลาดที่จะตอบสนองต่อการกระทำทางสังคมใด ๆ",
    type:'Samsung'
}, {
    id: 10,
    img: 'https://media-cdn.bnn.in.th/164830/Samsung-Smartphone-Galaxy-S21-FE-8+256-Lavender-5G-1-square_medium.jpg',
    name:"Samsung Galaxy S21 FE (8+128) Lavender (5G)",
    price: 19900,
    description: "Galaxy S21 FE ให้คุณไม่พลาดเก็บทุกโมเม้นท์สนุกๆ ยามค่ำคืน ด้วยกล้องที่ถ่ายภาพและวิดีโอกลางคืน ได้ทุกเลนส์ เห็นรายละเอียดคมชัด สีสด สวย ความเร็ว 5G ที่คุณจะต้องทึ่ง  ชาร์จได้เกิน 50% ใน 30 นาที Super Smooth 120Hz ที่เลื่อนดูได้อย่างสมูทสุด ๆ",
    type:'Samsung'
}, {
    id: 11,
    img: 'https://media-cdn.bnn.in.th/140493/iPhone_13_Pro_Graphite_1-square_medium.jpg',
    name:"Apple iPhone 13 Pro 512GB Graphite",
    price: 46900, 
    description: "iPhone 13 Pro การอัปเกรดระบบกล้องระดับโปรครั้งใหญ่ที่สุดเท่าที่เคยมีมา จอภาพ Super Retina XDR พร้อม ProMotion จึงทั้งเร็วขึ้นและรู้สึกได้ถึงการตอบสนองที่ฉับไวยิ่งขึ้น พร้อมชิป A15 Bionic ที่เร็วสุดขั้ว 5G ที่เร็วสุดแรง แถมยังมีดีไซน์ที่ทนทานและแบตเตอรี่ที่ใช้งานได้นานขึ้นแบบก้าวกระโดดครั้งใหญ่อีกด้วย",
    type:'Apple'
}, {
    id: 12,
    img: 'https://media-cdn.bnn.in.th/140314/iPhone_13_PDP_Position-1A_Color_Blue__1-square_medium.jpg',
    name:'Apple iPhone 13 128GB Blue',
    price: 29900,
    description: "iPhone 13 มาพร้อมระบบกล้องคู่สุดล้ำ ชิป A15 Bionic ที่เร็วสุดขั้ว แบตเตอรี่ที่ใช้งานได้นานขึ้นแบบก้าวกระโดดครั้งใหญ่ ดีไซน์ที่ทนทาน 5G ที่เร็วสุดแรง และจอภาพ Super Retina XDR ที่สว่างสดใส",
    type:'Apple'
}, {
    id: 13,
    img: 'https://media-cdn.bnn.in.th/140798/iPad_mini_Cellular_Pink_2-square_medium.jpg',
    name:"Apple iPad Mini 6 (2021) Wi-Fi + Cellular 64GB 8.3 inch Pink",
    price: 25900,
    description: "iPad mini 6 ใหม่ มาในดีไซน์แบบหน้าจอทั้งหมด พร้อมจอภาพ Liquid Retina ขนาด 8.3 นิ้ว ชิป A15 Bionic อันทรงพลังและ Neural Engine กล้องหน้าอัลตร้าไวด์ ความละเอียด 12MP พร้อมคุณสมบัติ 'จัดให้อยู่ตรงกลาง' การเชื่อมต่อแบบ USB-C อีกทั้งยังจดโน้ต ทำเครื่องหมายในเอกสาร หรือถ่ายทอดไอเดียสุดยิ่งใหญ่ได้ด้วย Apple Pencil (รุ่นที่ 2) ที่ยึดติดกับตัวเครื่องไว้ด้วยแม่เหล็กและชาร์จแบบไร้สาย",
    type:'Apple'
}, {
    id: 14,
    img: 'https://media-cdn.bnn.in.th/110159/Apple-iPhone-12-Purple-1-square_medium.jpg',
    name:"iPhone 12 64GB Purple",
    price: 24800,
    description: "เร็วยิ่งกว่าเร็ว ทั้งชิพที่เร็วที่สุดในสมาร์ทโฟนอย่าง A14 Bionicจอภาพ OLED แบบขอบจรดขอบ Ceramic Shield ที่ทนต่อการตกกระแทกได้ดีขึ้น 4 เท่า และโหมดกลางคืนบนกล้องทุกตัว iPhone 12 ก็มีหมดทุกอย่าง",
    type:'Apple'
}, {
    id: 15,
    img: 'https://media-cdn.bnn.in.th/147616/Apple_Watch_S7_CELL_SILVER-STAINLESS-STEEL_STARLIGHT-SB_45-mm-1-square_medium.jpg',
    name:"Apple Watch Series 7 GPS + Cellular 45mm Silver Stainless Steel Case with Starlight Sport Band",
    price: 24000,
    description: "Apple Watch Series 7 มาพร้อมระบบเซลลูลาร์ที่ช่วยให้คุณต่อติดกับคนรอบตัวและข้อมูลที่คุณใส่ใจได้เสมอ แม้ว่าคุณจะไม่มี iPhone อยู่กับตัวก็ตาม รับสายและตอบข้อความ สตรีมเพลงและพ็อดคาสท์ที่คุณชอบ นอกจากนี้ คุณรับความช่วยเหลือได้อย่างรวดเร็วด้วย SOS ฉุกเฉิน และยังโทรฉุกเฉินทั่วโลกได้อีกด้วย",
    type:'Apple'
},];

$(document).ready(() => {
    var html = '';
    for (let i = 0; i < product.length; i++) {
        html += `<div onclick="openproductDetail(${i})" class="product-items ${product[i].type}"> 
                    <img class="product-img" src="${product[i].img}" alt="">
                    <p class="font-product-nema">${product[i].name}</p>
                    <p class="font-product-price">${ number_commas(product[i].price) } THB</p>
                </div>`;
    }
    $("#productlist").html(html)

})

function number_commas(x) {
    x = x.toString();
    var pattern = /(-?\d+)(\d{3})/;
    while (pattern.test(x))
        x = x.replace(pattern, "$1,$2");
    return x
}

function searchsomething(elem) {
    
    var value = $("#"+elem.id).val()
    console.log(value)

    var html = '';
    for (let i = 0; i < product.length; i++) {
        if( product[i].name.includes(value) ) {
            html += `<div onclick="openproductDetail(${i})" class="product-items ${product[i].type}"> 
                        <img class="product-img" src="${product[i].img}" alt="">
                        <p class="font-product-nema">${product[i].name}</p>
                        <p class="font-product-price">${ number_commas(product[i].price) } THB</p>
                    </div>`;
            } 
    }
    if(html == '') {
        $("#productlist").html(`<p> Not found product </p>`)
    } 
    else {
        $("#productlist").html(html)  
    }
}

function searchproduct(param) {
    console.log(param)
    $(".product-items").css('display', 'none')
    if(param == 'all') {
        $(".product-items").css('display', 'block')
    }
    else {
        $("."+param).css('display', 'block')
    }
}

var productindex = 0;
function openproductDetail(index) {
    productindex = index;
    console.log(productindex)
    $("#modalDesc").css('display', 'flex')
    $("#mdd-img").attr('src', product[index].img);
    $("#mdd-name").text(product[index].name)
    $("#mdd-price").text(number_commas(product[index].price) + ' THB')
    $("#mdd-desc").text(product[index].description)
} 

function  closemodal() {
    $(".modal").css('display', 'none')
}
var cart = [];
function and_to_cart() {
    var pass = true;
    for (let i = 0; i < cart.length; i++) {
        if(productindex == cart[i].index) {
            console.log('found same product')
            cart[i].count++;
            pass = false;
        }
    }
    if(pass) {
        var obj = {
            index: productindex,
            id: product[productindex].id,
            name: product[productindex].name,
            price: product[productindex].price,
            img: product[productindex].img,
            count: 1
        };
        //console.log(obj)
        cart.push(obj)
    }
    console.log(cart)

    Swal.fire({
        icon: 'success',
        title: 'Add ' + product[productindex].name + ' to cart !'
    })
    $("#cartcount").css('display', 'flex').text(cart.length)
}

function opencart() {
    $("#modalCart").css('display', 'flex')
    rendercart();
}

function rendercart() {
    if(cart.length > 0) {
        var html = ''
        for ( let i = 0; i < cart.length; i++) {
            html += `<div class="carlist-items">
                        <div class="cartlist-lift">
                            <img src="${cart[i].img}">
                            <div class="carlist-detail">
                                <p class="modal-font-product-name">${cart[i].name}</p>
                                <p class="modal-font-product-price">${number_commas(cart[i].price)} THB</p>
                            </div>
                        </div>
                        <div class="cartlist-right">
                            <p onclick="deinitems('-', ${i})" class="btnc">-</p>
                            <p id="countitems${i}" style="margin:0 15px">${cart[i].count}</p>
                            <p onclick="deinitems('+', ${i})" class="btnc">+</p>
                        </div>
                    </div>    `;
        }
        $("#mycart").html(html)
    }
        
    else {
        $("#mycart").html(`<p>Not found product list</p>`)
    }
}

function deinitems(action,index) {
    if(action == '-') {
        if(cart[index].count > 0) {
            cart[index].count--;
            $("#countitems"+index).text(cart[index].count)

            if(cart[index].count <= 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Are you sure to delete?',
                    showConfirmButton: true,
                    showCancelButton: true,
                    confirmButtonText: 'Yes, delete it!',
                    cancelButtonText: 'No, cancel!'
                }).then((res) => {
                    if(res.isConfirmed) {
                        cart.splice(index,1)
                        console.log(cart)
                        rendercart();
                        $("#cartcount").css('display', 'flex').text(cart.length)

                        if(cart.length <= 0) {
                            $("#cartcount").css('display','none')
                        }
                    }
                    else {
                        cart[index].count++;
                        $("#countitems"+index).text(cart[index].count)
                    }
                })
            }
        }
    }
    else if(action == '+') {
        cart[index].count++;
        $("#countitems"+index).text(cart[index].count)
    }
}

function buynow() {
    
    if(cart.length > 0) {
        $("#cartcount").css('display','none')
        $("#mycart").html(`<p>Not found product list</p>`)
        
        Swal.fire({
            icon:   'success',
            title:  'Product ' + product[productindex].name
                    +'\n'+
                    'Price ' + product[productindex].price + ' THB'
                    +'\n'+
                    'Y:M:D ' + ' ----:--:--' 
        }).then((res) => {
            if(res.isConfirmed) {
                cart = [];
                closemodal();
            }
        })
        
    }
    
}